2次元正方イジングモデルをCTMRG(角転送行列繰り込み群)を用いて計算する。計算は次のステップで行った。

(0)初期設定  
ここでは4脚テンソルを定義した。この脚にスピンが対応している。4脚テンソルを$W$とし
$$W_{abcd} = e^{K[(2a - 1)(2b - 1) + (2b - 1)(2c - 1) + (2c - 1)(2d - 1) + (2d - 1)(2a - 1)]}$$
で定義する。ただし、$abcd$は$0$ or $1$である。また、本計算では境界条件を固定端とし、3脚テンソル$P$と2脚テンソル(角転送行列)$C$を次で定義する。
$$C_{ab} = \sum_{c}P_{abc} = \sum_{cd}W_{abcd}$$
ただし、固定端であるため、$c,d = 1$とした。また、脚の自由度の最大値として$\chi$を定めている。この値は計算によって変えている。

(1)測定
測定は環境テンソル$G$を用いて行う。これは中心を取り囲むように内側に4つの脚が生えているテンソルで次で定義している。
$$G_{abcd} = \sum C_{\xi\eta}P_{d\eta\mu}C_{\mu\nu}P_{c\mu\rho}C_{\rho\sigma}P_{b\rho\tau}C_{\tau\zeta}P_{a\zeta\xi}$$
また測定ではスピン相関と磁化を測っており次で計算している。
$$ 
O = \sum_{abcd}G_{abcd}W_{abcd} \\
\langle s\sigma \rangle = \frac{1}{O}\sum_{abcd}(2a - 1)(2b - 1)G_{abcd}W_{abcd} \\
\langle s \rangle = \frac{1}{O}\sum_{abcd}(2a - 1)G_{abcd}W_{abcd}
$$
環境テンソルは各大きさのテンソルで計算をしている。

(2)拡大  
2脚テンソルと3脚テンソルは測定に必要な大きさになるまで拡大をする。大きさ$L$から$L+1$をつくる方法は以下の通りである。
$$
C_{\xi\eta}^{(L+1)} = \sum_{afgd}C_{fg}^{(L)}P_{aef}^{(L)}P_{dgh}^{(L)}W_{abcd} \\
P_{c\mu\nu}^{(L+1)} = \sum_{a}P_{acf}^{(L)}W_{abcd}
$$
ただし添え字は適宜貼り換えている。

(3)圧縮  
テンソルの拡大をするとその足の大きさは$2^L$となり指数関数的に増加する。そこで脚の大きさを$\chi$で制限する。拡大された2脚テンソルを対角化し、固有値と直交行列を得て、固有値を大きい方から$\chi$個とってきて新しい2脚テンソルとすることを考える。
$$
\tilde{C} = \sum_{\rho,\sigma=0}^{\chi-1}\delta_{\rho\sigma}\omega_{\rho}
$$
ただし$\omega$は固有値である。また、得た直交行列$A$を用いて3脚テンソルも次で圧縮する。
$$
\tilde{P} = \sum_{\rho,\sigma=0}^{\chi - 1}\sum_{b,c}A_{a\rho}P_{abc}A_{c\sigma}
$$
これにより$C,P$の脚の大きさが$\chi$に制限される。

以上のステップを繰り返して測定を行った。また、テンソルの拡大による要素のオーバーフローを回避するため適宜テンソルを規格化している。ただし、ノルムは測定には関与しないためその値は保存していない。

コードは各関数をMypackageに収めており、notebookないのising_TN.ipynbに実際に測定を行った結果を収めている。スピン相関については温度による変化を計算し、磁化は系の大きさと$\chi$の大きさによる変化を計算した。